

# Проект обучение с учителем - качество модели
__Цель:__ 
 - Проанализировать данные ассоциации пастбищ «ЭкоФерма» для владельца молочного хозяйства «Вольный луг» для покупки буренок. разработать модель машинного обучения, которая поможет ему управлять рисками и принимать объективное решение о покупке.   
 - Создать две прогнозные модели для отбора бурёнок в поголовье:   
     1. прогнозирование возможного удоя коровы (целевой признак Удой не менее 6000кг/год)    
     2. расчет вероятности получения вкусного молока (целевой признак Вкус молока)
        
----

<div  style="border-radius: 10px; box-shadow: 2px 2px 2px; border: 1px solid; padding: 10px ">
    
    
## Вывод для заказчика

1. **Загрузка и предобработка данных**:
    
   - Были загружены данные и выявлены замечания по наличию дубликатов и неверных типов данных.
   - Переименованы столбцы всех датафреймов.
   - Проведена работа по предобработке данных.

    
2. **Обработка данных**:
    
   - Удалены дубликаты и устранены неявные дубликаты в 1-м и 3-м датафреймах.
   - Приведены данные к нужному типу (object -> float) и одинаковому формату.
   - По второму датафрейму замечаний не обнаружено.

    
3. **Исследовательский анализ**:
    
   - По количественным данным:
     - Большинство данных распределены нормально, за исключением СПО (наблюдается дискретность значений) и жирности (экспоненциальное возрастание).
     - В параметре "Жирность" наблюдаются выбросы, составляющие 13,69% от выборки.
   - По категориальным данным:
     - Относительно равное распределение (разница между параметрами не больше 18%).
     - В параметре "Имя отца" среди быков преобладают "Буйный" и "Барин" (34.3% и 38.4%).

    
4. **Матрица корреляции**:
    
   - Наиболее влиятельные признаки для удоя:
     - СПО (0.81)
     - ЭКЕ (0.77)
     - Жирность (0.6)
     - Содержание сырого протеина в корме (0.45)
   - По графикам рассеяния:
     - Коровы старше двух лет приносят больше молока.
     - Имя отца не коррелирует с целевым признаком, поэтому его лучше убрать.
     - Порода коровы равномерно влияет на целевой признак.

    
5. **Обучение модели линейной регрессии**:
   
    
По полученным метрикам среди трех моделей был проведен анализ, в результате которого была выбрана самая лучшая третья модель
  
   - Коэффициент детерминации (R2) равен 0.822, что указывает на хорошую объясняющую способность модели.
   - MAE равен 147 кг, RMSE составляет 190 кг.
   - Модель немного завышает оценку предсказания.
   - 95% доверительный интервал = (6092.3, 6220.9)   
   - Предсказаны удои коров продавцов, каждая из которых выдает более 6000 кг в год.

    
6. **Обучение и настройка**:
    
    - При обучении линейной регрессии было получено большое количество ложных предсказаний (FP).    
    - Для минимизации риска выбора коровы с невкусным молоком, была увеличена метрика `precision`.    
    - Модель верно предсказывает только в половине случаев, но минимизирует риск выбора невкусного молока.    
    - Применив модель на итоговой выборке, не было найдено коров для покупки из-за низкой корреляции с входными признаками.   
    - Требуется больше данных или изменение условий задачи (введение рейтинга вкуса или снижение `precision` до 0.9).   

    
**Предсказание**:
- Применив модели на итоговой выборке, получены рекомендации по покупке всех коров с учетом удоя и ноль коров с учетом вкуса.
</div>    

